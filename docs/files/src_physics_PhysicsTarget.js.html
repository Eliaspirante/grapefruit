<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>src/physics/PhysicsTarget.js - GrapeFruit Game Engine</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="https://en.gravatar.com/userimage/49218683/8654d0c767f327312ebb1ace7f5a8d8d.png" title="GrapeFruit Game Engine"></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: v0.0.2</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="../classes/gf.AnimatedSprite.html">gf.AnimatedSprite</a></li>
            
                <li><a href="../classes/gf.AssetLoader.html">gf.AssetLoader</a></li>
            
                <li><a href="../classes/gf.AudioLoader.html">gf.AudioLoader</a></li>
            
                <li><a href="../classes/gf.AudioManager.html">gf.AudioManager</a></li>
            
                <li><a href="../classes/gf.AudoPlayer.html">gf.AudoPlayer</a></li>
            
                <li><a href="../classes/gf.Camera.html">gf.Camera</a></li>
            
                <li><a href="../classes/gf.Circle.html">gf.Circle</a></li>
            
                <li><a href="../classes/gf.Clock.html">gf.Clock</a></li>
            
                <li><a href="../classes/gf.DisplayObjectContainer.html">gf.DisplayObjectContainer</a></li>
            
                <li><a href="../classes/gf.Ellipse.html">gf.Ellipse</a></li>
            
                <li><a href="../classes/gf.EventEmitter.html">gf.EventEmitter</a></li>
            
                <li><a href="../classes/gf.Game.html">gf.Game</a></li>
            
                <li><a href="../classes/gf.GameState.html">gf.GameState</a></li>
            
                <li><a href="../classes/gf.Gui.html">gf.Gui</a></li>
            
                <li><a href="../classes/gf.GuiItem.html">gf.GuiItem</a></li>
            
                <li><a href="../classes/gf.ImageLayer.html">gf.ImageLayer</a></li>
            
                <li><a href="../classes/gf.input.Gamepad.html">gf.input.Gamepad</a></li>
            
                <li><a href="../classes/gf.input.GamepadButtons.html">gf.input.GamepadButtons</a></li>
            
                <li><a href="../classes/gf.input.GamepadSticks.html">gf.input.GamepadSticks</a></li>
            
                <li><a href="../classes/gf.input.Input.html">gf.input.Input</a></li>
            
                <li><a href="../classes/gf.input.Keyboard.html">gf.input.Keyboard</a></li>
            
                <li><a href="../classes/gf.InputManager.html">gf.InputManager</a></li>
            
                <li><a href="../classes/gf.JsonLoader.html">gf.JsonLoader</a></li>
            
                <li><a href="../classes/gf.Layer.html">gf.Layer</a></li>
            
                <li><a href="../classes/gf.Loader.html">gf.Loader</a></li>
            
                <li><a href="../classes/gf.Map.html">gf.Map</a></li>
            
                <li><a href="../classes/gf.math.html">gf.math</a></li>
            
                <li><a href="../classes/gf.ObjectPool.html">gf.ObjectPool</a></li>
            
                <li><a href="../classes/gf.PhysicsTarget.html">gf.PhysicsTarget</a></li>
            
                <li><a href="../classes/gf.plugin.html">gf.plugin</a></li>
            
                <li><a href="../classes/gf.Point.html">gf.Point</a></li>
            
                <li><a href="../classes/gf.Polygon.html">gf.Polygon</a></li>
            
                <li><a href="../classes/gf.Rectangle.html">gf.Rectangle</a></li>
            
                <li><a href="../classes/gf.Sprite.html">gf.Sprite</a></li>
            
                <li><a href="../classes/gf.SpritePool.html">gf.SpritePool</a></li>
            
                <li><a href="../classes/gf.support.html">gf.support</a></li>
            
                <li><a href="../classes/gf.Texture.html">gf.Texture</a></li>
            
                <li><a href="../classes/gf.TextureFont.html">gf.TextureFont</a></li>
            
                <li><a href="../classes/gf.TextureLoader.html">gf.TextureLoader</a></li>
            
                <li><a href="../classes/gf.Tile.html">gf.Tile</a></li>
            
                <li><a href="../classes/gf.TiledLayer.html">gf.TiledLayer</a></li>
            
                <li><a href="../classes/gf.TiledMap.html">gf.TiledMap</a></li>
            
                <li><a href="../classes/gf.TiledObjectGroup.html">gf.TiledObjectGroup</a></li>
            
                <li><a href="../classes/gf.TiledTileset.html">gf.TiledTileset</a></li>
            
                <li><a href="../classes/gf.utils.html">gf.utils</a></li>
            
                <li><a href="../classes/gf.Vector.html">gf.Vector</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: src/physics/PhysicsTarget.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
/**
 * Physics mixin. This will add physics capabilities to the class it mixes into.
 *
 * @class PhysicsTarget
 * @namespace gf
 * @constructor
 * @example
 *      function MyObject(clr) {
 *          this.color = clr;
 *      }
 *
 *      gf.inherits(MyObject, Object, {
 *          something: function(s) {
 *          }
 *      });
 *      gf.PhysicsTarget.call(MyObject.prototype); //adds properties
 *
 *      //then later
 *      var o = new MyObject(&#x27;red&#x27;);
 *      o.enablePhysics(game.physics);
 */
 gf.PhysicsTarget = function() {
    /**
     * The physics system that this object is a part of. This is advisory only
     * please use enablePhysics() or disablePhysics() and do not set this value
     * directly.
     *
     * @property _psystem
     * @type PhysicsSystem
     * @default null
     * @private
     * @readOnly
     */
    this._psystem = null;

    /**
     * The mass of this object, please use setMass to set this value
     *
     * @property mass
     * @type Number
     * @default 0
     * @readOnly
     */
    this.mass = 0;

    /**
     * The moment of inertia of this object, only set this before enabling physics (has no effect after enabling)
     *
     * @property inertia
     * @type Number
     * @default 0
     */
    this.inertia = 0;

    /**
     * Enables physics for this sprite
     *
     * @method enablePhysics
     * @param system {PhysicsSystem} The system for the sprite to be in
     */
    this.enablePhysics = function(sys) {
        if(sys &amp;&amp; this._psystem !== sys) {
            if(this._psystem)
                this._psystem.remove(this);

            this._psystem = sys;
        }

        this._psystem.add(this);
    };

    /**
     * Disbales physics for this sprite
     *
     * @method disablePhysics
     */
    this.disablePhysics = function() {
        if(this._psystem) {
            this._psystem.remove(this);

            if(this._hit) {
                this._showHit = false;
                this.parent.removeChild(this._hit);
                this._hit = null;
            }
        }
    };

    /**
     * Sets the mass of this sprite
     *
     * @method setMass
     * @param mass {Number} The new mass of the object
     */
    this.setMass = function(mass) {
        if(this._psystem) {
            this._psystem.setMass(this, mass);
        }
    };

    /**
     * Sets the velocity of this sprite
     *
     * @method setVelocity
     * @param velocity {Vector} The new velocity of the object
     */
    this.setVelocity = function(vel) {
        if(this._psystem) {
            this._psystem.setVelocity(this, gf.utils.ensureVector(vel));
        }
    };

    /**
     * Sets the rotation of this sprite
     *
     * @method setRotation
     * @param rotation {Number} The new rotation of the object in radians
     */
    this.setRotation = function(rads) {
        this.rotation = rads;

        if(this._psystem) {
            this._psystem.setRotation(this, rads);
        }
    };

    /**
     * Sets the position of this sprite
     *
     * @method setPosition
     * @param x {Number}
     * @param y {Number}
     */
    this.setPosition = function(x, y) {
        this.position.x = x;
        this.position.y = y;

        if(this._psystem) {
            this._psystem.setPosition(this, this.position);
        }
    };

    /**
     * On Collision Event
     *      called when this sprite collides into another, or is being collided into by another.
     *      By default if something collides with a collectable sprite we destroy the collectable
     *      and if we collide with a solid tile we kill our velocity. This method will emit a
     *      &#x27;collision&#x27; event that you can listen for
     *
     * @method onCollision
     * @param obj {Sprite} Colliding sprite
     * @param vec {Vector} Collision vector (for sensors this is normalized)
     * @param colShape {cp.Shape} The colliding physics shape
     * @param myShape {Sprite} Your physics shape that caused the collision
     */
    this.onCollision = function(obj, vec, colShape, myShape) {
        if(obj.type === gf.Sprite.TYPE.COLLECTABLE)
            obj.destroy();

        this.emit(&#x27;collision&#x27;, obj, vec, colShape, myShape);
    };

    /**
     * On Seperate Event
     *      called when this sprite collides into another, or is being collided into by another.
     *      By default if something collides with a collectable sprite we destroy the collectable
     *      and if we collide with a solid tile we kill our velocity. This method will emit a
     *      &#x27;collision&#x27; event that you can listen for
     *
     * @method onCollision
     * @param obj {Sprite} Colliding sprite
     * @param colShape {cp.Shape} The colliding physics shape
     * @param myShape {Sprite} Your physics shape that caused the collision
     */
    this.onSeparate = function(obj, colShape, myShape) {
        this.emit(&#x27;separate&#x27;, obj, colShape, myShape);
    };

    /**
     * Shows the physics body for the sprite
     *
     * @method showPhysics
     */
    this.showPhysics = function(style) {
        this._showHit = true;
        if(!this._phys || !this._phys.body || !this._phys.shape)
            return;

        //no graphics object created yet
        if(!this._hit) {
            this._hit = new PIXI.Graphics();

            this.parent.addChild(this._hit);
        }

        //pass a new style, or haven&#x27;t defined one yet
        if(style || !this._hit.style) {
            style = this._setStyleDefaults(style);
            style.sensor = this._setStyleDefaults(style.sensor);

            this._hit.style = style;
        }

        var p = this._phys.body.p,
            g = this._hit,
            c = this._phys.customShapes;

        if(!this._hit.lastPos)
            this._hit.lastPos = new gf.Point();
        else if(this._hit.lastPos.x === p.x &amp;&amp; this._hit.lastPos.y === p.y)
            return;

        this._hit.lastPos.x = p.x;
        this._hit.lastPos.y = p.y;

        g.clear();
        this._drawPhysicsShape(this._phys.shape, g, p);

        if(c) {
            for(var i = 0; i &lt; c.length; ++i) {
                this._drawPhysicsShape(c[i], g, p);
            }
        }
    };

    this._setStyleDefaults = function(style) {
        style = style || {};
        style.size = style.size || 1;
        style.color = style.color || 0xff00ff;
        style.alpha = style.alpha || 1;

        return style;
    };

    this._drawPhysicsShape = function(shape, g, p) {
        var style = g.style;

        if(shape.sensor)
            style = style.sensor;

        g.lineStyle(style.size, style.color, style.alpha);

        //circle
        if(shape.type === &#x27;circle&#x27;) {
            var cx = shape.bb_l + ((shape.bb_r - shape.bb_l) / 2),
                cy = shape.bb_t + ((shape.bb_b - shape.bb_t) / 2);

            g.drawCircle(cx, cy, shape.r);
        }
        //polygon
        else {
            var sx = shape.verts[0],
                sy = shape.verts[1];

            g.moveTo(p.x + sx, p.y + sy);

            for(var i = 2; i &lt; shape.verts.length; i+=2) {
                g.lineTo(
                    p.x + shape.verts[i],
                    p.y + shape.verts[i + 1]
                );
            }

            g.lineTo(p.x + sx, p.y + sy);
        }
    };

    /**
     * Hides the physics body for the sprite
     *
     * @method hidePhysics
     */
    this.hidePhysics = function() {
        this._showHit = false;
        if(this._hit) {
            this._hit.visible = false;
        }
    };
};
    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
